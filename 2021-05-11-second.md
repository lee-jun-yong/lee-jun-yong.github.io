```python
  #preamble
from IPython.display import set_matplotlib_formats, display
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import mglearn
from cycler import cycler

# 맷플롯립 한글 폰트 지정
import matplotlib
matplotlib.rc('font', family='NanumBarunGothic')
matplotlib.rcParams['axes.unicode_minus'] = False

set_matplotlib_formats('pdf', 'png')
plt.rcParams['savefig.dpi'] = 300
plt.rcParams['figure.dpi'] = 300
plt.rcParams['image.cmap'] = "viridis"
plt.rcParams['image.interpolation'] = "none"
plt.rcParams['savefig.bbox'] = "tight"
plt.rcParams['lines.linewidth'] = 2
plt.rcParams['legend.numpoints'] = 1
plt.rc('axes', prop_cycle=(
    cycler('color', mglearn.plot_helpers.cm_cycle.colors) +
    cycler('linestyle', ['-', '-', "--", (0, (3, 3)), (0, (1.5, 1.5))])))


np.set_printoptions(precision=3, suppress=True)

pd.set_option("display.max_columns", 8)
pd.set_option('precision', 2)

__all__ = ['np', 'mglearn', 'display', 'plt', 'pd']
```


```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import mglearn
import graphviz
```


```python

from sklearn.model_selection import train_test_split
from sklearn.datasets import make_moons
from sklearn.datasets import load_breast_cancer

Xm, ym = make_moons(n_samples=100, noise=0.25, random_state=3)
Xm_train, Xm_test, ym_train, ym_test = train_test_split(
    Xm, ym, stratify=ym, random_state=42)

cancer = load_breast_cancer()
Xc_train, Xc_test, yc_train, yc_test = train_test_split(
    cancer.data, cancer.target, random_state=0)
```


```python
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import BaggingClassifier
bagging = BaggingClassifier(LogisticRegression(),n_estimators=100,
                            oob_score=True,n_jobs=-1,random_state=42)
bagging.fit(Xc_train,yc_train)
```


    ---------------------------------------------------------------------------

    UnicodeEncodeError                        Traceback (most recent call last)

    <ipython-input-4-f58005e95fa1> in <module>
          3 bagging = BaggingClassifier(LogisticRegression(),n_estimators=100,
          4                             oob_score=True,n_jobs=-1,random_state=42)
    ----> 5 bagging.fit(Xc_train,yc_train)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\sklearn\ensemble\_bagging.py in fit(self, X, y, sample_weight)
        242         self : object
        243         """
    --> 244         return self._fit(X, y, self.max_samples, sample_weight=sample_weight)
        245 
        246     def _parallel_args(self):
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\sklearn\ensemble\_bagging.py in _fit(self, X, y, max_samples, max_depth, sample_weight)
        368         self._seeds = seeds
        369 
    --> 370         all_results = Parallel(n_jobs=n_jobs, verbose=self.verbose,
        371                                **self._parallel_args())(
        372             delayed(_parallel_build_estimators)(
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\parallel.py in __call__(self, iterable)
        964 
        965         if not self._managed_backend:
    --> 966             n_jobs = self._initialize_backend()
        967         else:
        968             n_jobs = self._effective_n_jobs()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\parallel.py in _initialize_backend(self)
        731         """Build a process or thread pool and return the number of workers"""
        732         try:
    --> 733             n_jobs = self._backend.configure(n_jobs=self.n_jobs, parallel=self,
        734                                              **self._backend_args)
        735             if self.timeout is not None and not self._backend.supports_timeout:
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\_parallel_backends.py in configure(self, n_jobs, parallel, prefer, require, idle_worker_timeout, **memmappingexecutor_args)
        492                 SequentialBackend(nesting_level=self.nesting_level))
        493 
    --> 494         self._workers = get_memmapping_executor(
        495             n_jobs, timeout=idle_worker_timeout,
        496             env=self._prepare_worker_env(n_jobs=n_jobs),
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\executor.py in get_memmapping_executor(n_jobs, **kwargs)
         18 
         19 def get_memmapping_executor(n_jobs, **kwargs):
    ---> 20     return MemmappingExecutor.get_memmapping_executor(n_jobs, **kwargs)
         21 
         22 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\executor.py in get_memmapping_executor(cls, n_jobs, timeout, initializer, initargs, env, temp_folder, context_id, **backend_args)
         40         _executor_args = executor_args
         41 
    ---> 42         manager = TemporaryResourcesManager(temp_folder)
         43 
         44         # reducers access the temporary folder in which to store temporary
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\_memmapping_reducer.py in __init__(self, temp_folder_root, context_id)
        529             # exposes exposes too many low-level details.
        530             context_id = uuid4().hex
    --> 531         self.set_current_context(context_id)
        532 
        533     def set_current_context(self, context_id):
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\_memmapping_reducer.py in set_current_context(self, context_id)
        533     def set_current_context(self, context_id):
        534         self._current_context_id = context_id
    --> 535         self.register_new_context(context_id)
        536 
        537     def register_new_context(self, context_id):
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\_memmapping_reducer.py in register_new_context(self, context_id)
        558                 new_folder_name, self._temp_folder_root
        559             )
    --> 560             self.register_folder_finalizer(new_folder_path, context_id)
        561             self._cached_temp_folders[context_id] = new_folder_path
        562 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\_memmapping_reducer.py in register_folder_finalizer(self, pool_subfolder, context_id)
        588         # semaphores and pipes
        589         pool_module_name = whichmodule(delete_folder, 'delete_folder')
    --> 590         resource_tracker.register(pool_subfolder, "folder")
        591 
        592         def _cleanup():
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py in register(self, name, rtype)
        189         '''Register a named resource, and increment its refcount.'''
        190         self.ensure_running()
    --> 191         self._send('REGISTER', name, rtype)
        192 
        193     def unregister(self, name, rtype):
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\joblib\externals\loky\backend\resource_tracker.py in _send(self, cmd, name, rtype)
        202 
        203     def _send(self, cmd, name, rtype):
    --> 204         msg = '{0}:{1}:{2}\n'.format(cmd, name, rtype).encode('ascii')
        205         if len(name) > 512:
        206             # posix guarantees that writes to a pipe of less than PIPE_BUF
    

    UnicodeEncodeError: 'ascii' codec can't encode characters in position 18-20: ordinal not in range(128)



```python
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import BaggingClassifier
bagging = BaggingClassifier(LogisticRegression(), n_estimators=100, 
                            oob_score=True, n_jobs=-1, random_state=42)
bagging.fit(Xc_train, yc_train)
```


```python
from sklearn.ensemble import ExtraTreesClassifier
xtree = ExtraTreesClassifier(n_estimators=5,n_jobs=-1,random_state=0)
xtree.fit(Xm_train,ym_train)
```


```python
fig,axes = plt.subplots(2,3,figsize=(20,10))
for i,(ax,tree) in enumerate(zip(axes.ravel(),xtree.estimators_)):
    ax.set_title("tree {}".format(i))
    mglearn.plots.plot_tree_partition(Xm,ym,tree,ax=ax)

mglearn.plots.plot_2d_separator(xtree,Xm,fill=True,ax=axes[-1,-1],alpha=0.4)
axes[-1,-1].set_title("extra tree")
mglearn.discrete_scatter(Xm[:,0],Xm[:,1],ym)
plt.show()
```


```python
xtree =ExtraTreesClassifier(n_estimators=100,n_jobs=-1,random_state=0)
xtree.fit(Xc_train,yc_train)
```


```python
print(xtree.score(Xc_train,yc_train))
print(xtree.score(Xc_test,yc_test))
```


```python
from sklearn.ensemble import AdaBoostClassifier
ada = AdaBoostClassifier(n_estimators=5,random_state=42)
ada.fit(Xm_train,ym_train)
```


```python
fig,axes = plt.subplots(2,3,figsize=(20,10))
for i,(ax,tree) in enumerate(zip(axes.ravel(),ada.estimators_)):
    ax.set_title("tree {}".format(i))
    mglearn.plots.plot_tree_partition(Xm,ym,tree,ax=ax)
    
mglearn.plots.plot_2d_separator(ada,Xm,fill=True,ax=axes[-1,-1],alpha=.4)
axes[-1,-1].set_title("ada boost")
mglearn.discrete_scatter(Xm[:,0],Xm[:,1],ym)
plt.show()
```


```python
fig, axes = plt.subplots(2, 3, figsize=(20, 10))
for i, (ax, tree) in enumerate(zip(axes.ravel(), ada.estimators_)):
    ax.set_title("Tree {}".format(i))
    mglearn.plots.plot_tree_partition(Xm, ym, tree, ax=ax)
    
mglearn.plots.plot_2d_separator(ada, Xm, fill=True, ax=axes[-1, -1], alpha=.4)
axes[-1, -1].set_title("AdaBoost")
mglearn.discrete_scatter(Xm[:, 0], Xm[:, 1], ym)
plt.show()
```


```python
from sklearn.datasets import make_blobs

X, y = make_blobs(centers=4, random_state=8)
y = y % 2

mglearn.discrete_scatter(X[:, 0], X[:, 1], y)
plt.xlabel("특성 0")
plt.ylabel("특성 1")
plt.show() # 책에는 없음
```

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_12_2.png)
    



```python
from sklearn.svm import LinearSVC
linear_svm = LinearSVC(max_iter=5000, tol=1e-3).fit(X, y)

mglearn.plots.plot_2d_separator(linear_svm, X)
mglearn.discrete_scatter(X[:, 0], X[:, 1], y)
plt.xlabel("특성 0")
plt.ylabel("특성 1")
plt.show() # 책에는 없음
```

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_13_2.png)
    



```python
X_new =np.hstack([X,X[:,1:] **2])
from mpl_toolkits.mplot3d import Axes3D, axes3d
figure =plt.figure()
ax=Axes3D(figure,elev=-0,azim=-26)
mask = y ==0
ax.scatter(X_new[mask,0],X_new[mask,1],X_new[mask,2],c='b',
          cmap=mglearn.cm2,s=60,edgecolor='k')
ax.scatter(X_new[~mask,0],X_new[~mask,1],X_new[~mask,2],c='r',marker='^',
          cmap=mglearn.cm2,s=60,edgecolor='k')
ax.set_xlabel("feature 0")
ax.set_ylabel("featrue 1")
ax.set_zlabel("featrue 2")
```




    Text(0.5, 0, 'featrue 2')



    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_14_3.png)
    



```python
linear_svm_3d = LinearSVC(max_iter=5000).fit(X_new, y)
coef, intercept = linear_svm_3d.coef_.ravel(), linear_svm_3d.intercept_

# 선형 결정 경계 그리기
figure = plt.figure()
ax = Axes3D(figure, elev=-152, azim=-26)
xx = np.linspace(X_new[:, 0].min() - 2, X_new[:, 0].max() + 2, 50)
yy = np.linspace(X_new[:, 1].min() - 2, X_new[:, 1].max() + 2, 50)

XX, YY = np.meshgrid(xx, yy)
ZZ = (coef[0] * XX + coef[1] * YY + intercept) / -coef[2]
ax.plot_surface(XX, YY, ZZ, rstride=8, cstride=8, alpha=0.3)
ax.scatter(X_new[mask, 0], X_new[mask, 1], X_new[mask, 2], c='b',
           cmap=mglearn.cm2, s=60, edgecolor='k')
ax.scatter(X_new[~mask, 0], X_new[~mask, 1], X_new[~mask, 2], c='r', marker='^',
           cmap=mglearn.cm2, s=60, edgecolor='k')

ax.set_xlabel("특성0")
ax.set_ylabel("특성1")
ax.set_zlabel("특성1 ** 2")
plt.show() # 책에는 없음
```

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_15_2.png)
    



```python
ZZ = YY ** 2
dec = linear_svm_3d.decision_function(np.c_[XX.ravel(),YY.ravel(),ZZ.ravel()])
plt.contourf(XX,YY,dec.reshape(XX.shape),levels=[dec.min(),0,dec.max()],
            cmap = mglearn.cm2,alpha=0.5)
mglearn.discrete_scatter(X[:,0],X[:,1],y)
plt.xlabel("feature 0")
plt.ylabel("featrue 1")
```




    Text(0, 0.5, 'featrue 1')



    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_16_3.png)
    



```python
from sklearn.svm import SVC

X, y = mglearn.tools.make_handcrafted_dataset()                                                                  
svm = SVC(kernel='rbf', C=10, gamma=0.11).fit(X, y)                                                
mglearn.plots.plot_2d_separator(svm, X, eps=.5)
# 데이터 포인트 그리기
mglearn.discrete_scatter(X[:, 0], X[:, 1], y)
# 서포트 벡터
sv = svm.support_vectors_
# dual_coef_ 의 부호에 의해 서포트 벡터의 클래스 레이블이 결정됩니다
sv_labels = svm.dual_coef_.ravel() > 0
mglearn.discrete_scatter(sv[:, 0], sv[:, 1], sv_labels, s=15, markeredgewidth=3)
plt.xlabel("특성 0")
plt.ylabel("특성 1")
plt.show() # 책에는 없음
```

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_17_2.png)
    



```python
fig,axes = plt.subplots(3,3,figsize=(15,10))

for ax,C in zip(axes,[-1,0,3]):
    for a,gamma in zip(ax,range(-1,2)):
        mglearn.plots.plot_svm(log_C=C,log_gamma=gamma,ax=a)
        
axes[0,0].legend(["class 0","class 1","class 0 sv","class 1 sv"],ncol=4,loc=(.9,1.2))
```




    <matplotlib.legend.Legend at 0x16161a8>



    findfont: Font family ['NanumBarunGothic'] not found. Falling back to DejaVu Sans.
    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_18_3.png)
    



```python
X_train,X_test,y_train,y_test = train_test_split(
    cancer.data,cancer.target,random_state=0)

svc = SVC()
svc.fit(X_train,y_train)

print(svc.score(X_train,y_train))
print(svc.score(X_test,y_test))
```

    0.903755868544601
    0.9370629370629371
    


```python
plt.boxplot(X_train, manage_ticks=False)
plt.yscale("symlog")
plt.xlabel("특성 목록")
plt.ylabel("특성 크기")
plt.show()
```

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 47785 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 47197 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53356 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 44592 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 47785 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 47197 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53356 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 44592 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 47785 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 47197 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53356 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 44592 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_20_2.png)
    



```python
min_on_training = X_train.min(axis=0)
range_on_training = (X_train - min_on_training).max(axis=0)

X_train_scaled = (X_train - min_on_training) / range_on_training
X_test_scaled = (X_test - min_on_training) / range_on_training

```


```python
svc = SVC()
svc.fit(X_train_scaled,y_train)

print(svc.score(X_train_scaled,y_train))
print(svc.score(X_test_scaled,y_test))

```

    0.9835680751173709
    0.972027972027972
    


```python
svc = SVC(C=1000)
svc.fit(X_train_scaled,y_train)

print(svc.score(X_train_scaled,y_train))
print(svc.score(X_test_scaled,y_test))

```

    1.0
    0.958041958041958
    


```python
display(mglearn.plots.plot_logistic_regression_graph())
```


    
![svg](output_24_0.svg)
    



```python
line =np.linspace(-3,3,100)
plt.plot(line,np.tanh(line),label = "tanh")
plt.plot(line,np.maximum(line,0),linestyle="--",label="relu")
plt.legend(loc="best")

```




    <matplotlib.legend.Legend at 0x1e8d1dc0>



    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_25_3.png)
    



```python
from sklearn.neural_network import MLPClassifier
from sklearn.datasets import make_moons

X,y = make_moons(n_samples=100,noise=0.25,random_state =3)

X_train,X_test,y_train,y_test = train_test_split(X,y,stratify = y, random_state=42)

mlp=MLPClassifier(solver='lbfgs',random_state=0).fit(X_train,y_train)
mglearn.plots.plot_2d_separator(mlp,X_train,fill=True,alpha=.3)
mglearn.discrete_scatter(X_train[:,0],X_train[:,1],y_train)
plt.xlabel("feature 0")
plt.ylabel("feature 1")

```




    Text(0, 0.5, 'feature 1')



    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_26_3.png)
    



```python
mlp=MLPClassifier(solver='lbfgs',random_state=0,hidden_layer_sizes=[10]).fit(X_train,y_train)
mglearn.plots.plot_2d_separator(mlp,X_train,fill=True,alpha=.3)
mglearn.discrete_scatter(X_train[:,0],X_train[:,1],y_train)
plt.xlabel("feature 0")
plt.ylabel("feature 1")
```

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:500: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
      self.n_iter_ = _check_optimize_result("lbfgs", opt_res, self.max_iter)
    




    Text(0, 0.5, 'feature 1')



    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_27_4.png)
    



```python
fig,axes = plt.subplots(2,4,figsize=(20,8))
for axx, n_hidden_nodes in zip(axes,[10,100]):
    for ax,alpha in zip(axx,[0.001,0.01,0.1,1]):
        mlp = MLPClassifier(solver='lbfgs',random_state=0,
                           hidden_layer_sizes=[n_hidden_nodes,n_hidden_nodes],
                           alpha=alpha)
        mlp.fit(X_train,y_train)
        mglearn.plots.plot_2d_separator(mlp,X_train,fill=True,alpha=.3,ax=ax)
        mglearn.discrete_scatter(X_train[:,0],X_train[:,1],y_train,ax=ax)
        ax.set_title("n_hidden=[{} , {}]\n alpha={:.4f}".format(n_hidden_nodes,n_hidden_nodes,alpha))
```

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:500: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
      self.n_iter_ = _check_optimize_result("lbfgs", opt_res, self.max_iter)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:500: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
      self.n_iter_ = _check_optimize_result("lbfgs", opt_res, self.max_iter)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:500: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
      self.n_iter_ = _check_optimize_result("lbfgs", opt_res, self.max_iter)
    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_28_2.png)
    



```python
print(cancer.data.max(axis=0))
```

    [  28.11    39.28   188.5   2501.       0.163    0.345    0.427    0.201
        0.304    0.097    2.873    4.885   21.98   542.2      0.031    0.135
        0.396    0.053    0.079    0.03    36.04    49.54   251.2   4254.
        0.223    1.058    1.252    0.291    0.664    0.207]
    


```python
print(cancer.data.max(axis=1))
```

    [2019.  1956.  1709.   567.7 1575.   741.6 1606.   897.   739.3  711.4
     1150.  1299.  1332.   876.5  697.7  943.2 1138.  1315.  2398.   711.2
      630.5  314.9  980.9 2615.  2215.  1461.   896.9 1403.  1269.  1227.
     1670.   888.7 1344.  1813.  1261.  1229.   799.6  545.9  698.8  740.4
      787.9  514.  1651.   907.2  740.7 1567.   242.2  759.4  582.6  698.8
      516.5  656.7  527.2 1321.  1030.   506.2 2145.   985.5  624.1  274.9
      368.6  273.9  959.5  310.1  888.3  925.1  330.7  466.7  324.7  554.9
     1866.   284.4 1681.   812.4  611.1 1223.   605.5 1610.  1623.   622.1
      525.1  614.9 2562.  1298.   567.9 1603.   808.9 1623.   574.7  803.6
      803.7  830.9  830.6  699.4 1025.  1750.   495.2  366.1  512.5  826.4
      906.5  185.2  547.8  361.2  402.8  827.2  521.7  544.1 2360.   518.1
      367.   527.4  709.   374.4  284.4  583.   270.  1095.  1272.  1261.
      510.5 1549.  2073.   745.5  632.1  725.9  848.7 1538.   762.6 1589.
      545.2 1156.  1175.   922.8 1590.   653.6  546.7  462.   971.4  434.
      342.9 1233.   503.   643.8  441.2  509.6  591.7  809.7  766.9  725.9
      616.7  249.8  380.5  440.8  677.3  564.2 1302.  1032.   532.8  470.
      543.9 1495.  2232.   553.  2403.   782.1  414.  1260.  1660.   793.7
      549.1  993.6 1102.   396.5  408.3  259.2  390.2  981.2  608.8  570.7
     3216.  2089.  1269.   467.2  973.1  437.  1410.   521.5  489.5  546.7
      762.4  579.5  303.8  768.9  784.7  600.6  806.9 1228.  1688.  1044.
      638.4 1239.  1986.  1153.   677.9  989.5  331.6 1210.   639.3  932.7
     1656.   546.3 2499.  1021.   811.3  750.1  531.2  403.7 2009.  2477.
      706.2  686.6  375.6 1088.   708.8  873.2  395.4  808.2  624.   706.
     1189.   452.3  470.9 1872.   335.9  715.5 2944.  1750.   764.  1408.
      683.4  543.4  472.9  706.  1417.   402.8  602.   639.1  455.7  491.8
     2010.   508.9 1933.  1222.  1972.   826.  1926.   928.8 1226.  1035.
     1844.  1218.  1295.   988.6 1436.  3432.   424.8  661.5  597.5  410.4
      684.6  457.5 2384.   355.2 1320.   472.4  458.  1236.   739.1  670.
     1724.   533.7 1628.  1031.   595.6  564.1  546.1  577.   437.6  459.3
      767.3  809.8  585.4  517.8  553.7  661.1  392.2  553.6  819.7  362.7
     2053.   551.3 1696.   375.4  489.8  476.5  636.9  285.5  698.7  672.4
      483.1  840.8  618.8  467.8  240.1  544.2  513.1 1485.   297.1  515.9
      390.4 1657.   599.5 1938.   583.1  574.4  749.9  523.4 1121.   975.2
     1070.   634.3  436.1  492.7  544.3 1362.   576.  1873.   384.  2906.
      862.1  353.6  440.  1540.   516.4  357.1  562.6  880.8  475.8  496.2
      542.5  915.3 3234.  1050.   453.5  547.4  591.2  694.4  302.   439.6
      585.7  621.2  579.7 1009.   663.5 1780.  1671.   624.6 3143.  2227.
     1165.   819.1 1535.  1946.   670.6  861.5  351.9  680.6  657.   508.1
      476.1  447.1  488.4  600.5  623.7  758.2  529.9  745.3  450.  1313.
      394.5  317.  1359.  2081.   559.5  684.5  675.2  591.   496.7  562.
     1304.   589.5  621.9  580.9  533.1  472.4  947.9  645.8 1349.   610.2
      521.3  471.4  301.   867.1  931.4  522.9  359.4 1748.   566.9  458.
      520.5  809.2  475.7  708.8  380.9  376.3  440.4  489.5  421.1  586.8
      832.7  515.8 1479.  1603.   777.5  869.3  626.9  750.   749.1  688.9
      476.4 1284.   706.6  366.3 1292.   513.9 1437.   829.5  830.5 2022.
      507.2 1421.   523.7  749.9  633.5  705.6  527.8  632.9  628.5  349.9
     1648.  4254.   734.6  495.1  687.6  733.5  689.1  380.2 1437.   528.1
      385.2  567.6  906.6  558.9  433.1  605.8  828.5  718.9  467.6  939.7
      547.4  830.5  660.2  686.5  854.3  580.6  831.  1740.   549.8 1084.
      622.9 1210.  1426.   534.   648.3  783.6  633.7  607.3 1600.  1760.
      856.9  788.   552.  2782.   300.2  328.1  515.3  411.1  928.2  909.4
      473.8  760.2  844.4  862.   967.   478.6 1493.  1646.   674.7  624.1
      326.6 2642.   435.9  701.9  376.5  275.6  719.8  564.9  653.3  549.9
      552.3  550.6  773.4 1645.   407.5 1809.   728.3  487.7  248.   223.6
      457.8  808.9  826.4  629.6  688.6  729.8  384.9  357.4  364.2  505.6
      412.3  436.6  594.7  295.8  595.7  357.6  347.3  330.6  733.5  474.2
      706.7  439.6  915.  1819.  2027.  1731.  1124.  1821.   268.6]
    


```python
cancer.data.shape
```




    (569, 30)




```python
X_train, X_test, y_train, y_test = train_test_split(
    cancer.data, cancer.target, random_state=0)

mlp = MLPClassifier(random_state=42)
mlp.fit(X_train, y_train)
```




    MLPClassifier(random_state=42)




```python
mean_on_train = X_train.mean(axis=0)
std_on_train = X_train.std(axis=0)

X_train_scaled = (X_train - mean_on_train) / std_on_train
X_test_scaled =(X_test - mean_on_train) / std_on_train

mlp= MLPClassifier(random_state=0)
mlp.fit(X_train_scaled,y_train)

print(mlp.score(X_train_scaled,y_train))
print(mlp.score(X_test_scaled,y_test))
```

    0.9906103286384976
    0.965034965034965
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:614: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
      warnings.warn(
    


```python
# 훈련 세트 각 특성의 평균을 계산합니다
mean_on_train = X_train.mean(axis=0)
# 훈련 세트 각 특성의 표준 편차를 계산합니다
std_on_train = X_train.std(axis=0)

# 데이터에서 평균을 빼고 표준 편차로 나누면
# 평균 0, 표준 편차 1 인 데이터로 변환됩니다.
X_train_scaled = (X_train - mean_on_train) / std_on_train
# (훈련 데이터의 평균과 표준 편차를 이용해) 같은 변환을 테스트 세트에도 합니다
X_test_scaled = (X_test - mean_on_train) / std_on_train

mlp = MLPClassifier(random_state=0)
mlp.fit(X_train_scaled, y_train)

print("훈련 세트 정확도: {:.3f}".format(mlp.score(X_train_scaled, y_train)))
print("테스트 세트 정확도: {:.3f}".format(mlp.score(X_test_scaled, y_test)))
```

    훈련 세트 정확도: 0.991
    테스트 세트 정확도: 0.965
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:614: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
      warnings.warn(
    


```python
from sklearn.ensemble import GradientBoostingClassifier
from sklearn.datasets import make_circles

X,y =make_circles(noise = 0.25,factor =0.5,random_state=1)

y_named = np.array(["blue","red"])[y]

X_train,X_test,y_train_named,y_test_named,y_train,y_test = \
    train_test_split(X,y_named,y,random_state=0)

gbrt = GradientBoostingClassifier(random_state=0)
gbrt.fit(X_train,y_train_named)

```




    GradientBoostingClassifier(random_state=0)




```python
X_test.shape
```




    (25, 2)




```python
gbrt.decision_function(X_test).shape
```




    (25,)




```python
gbrt.decision_function(X_test)[:6]
```




    array([ 4.136, -1.702, -3.951, -3.626,  4.29 ,  3.662])




```python
gbrt.decision_function(X_test) >0
```




    array([ True, False, False, False,  True,  True, False,  True,  True,
            True, False,  True,  True, False,  True, False, False, False,
            True,  True,  True,  True,  True, False, False])




```python
greater_zero = (gbrt.decision_function(X_test)>0).astype(int)
pred = gbrt.classes_[greater_zero]
print(np.all(pred == gbrt.predict(X_test)))
```

    True
    


```python
pred
```




    array(['red', 'blue', 'blue', 'blue', 'red', 'red', 'blue', 'red', 'red',
           'red', 'blue', 'red', 'red', 'blue', 'red', 'blue', 'blue', 'blue',
           'red', 'red', 'red', 'red', 'red', 'blue', 'blue'], dtype='<U4')




```python
y_train_named
```




    array(['blue', 'blue', 'blue', 'blue', 'blue', 'blue', 'blue', 'blue',
           'blue', 'red', 'blue', 'red', 'blue', 'blue', 'blue', 'red', 'red',
           'red', 'red', 'red', 'blue', 'blue', 'red', 'blue', 'blue', 'blue',
           'red', 'red', 'red', 'blue', 'blue', 'blue', 'blue', 'red', 'blue',
           'red', 'red', 'blue', 'red', 'blue', 'red', 'red', 'blue', 'red',
           'red', 'blue', 'blue', 'red', 'red', 'blue', 'red', 'blue', 'blue',
           'red', 'red', 'blue', 'red', 'blue', 'blue', 'blue', 'red', 'blue',
           'red', 'red', 'red', 'blue', 'blue', 'red', 'blue', 'red', 'blue',
           'red', 'blue', 'red', 'red'], dtype='<U4')




```python
greater_zero
```




    array([1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1,
           1, 0, 0])




```python
fig,axes = plt.subplots(1,2,figsize=(13,5))

mglearn.tools.plot_2d_separator(gbrt,X,ax=axes[0],alpha=.4,
                               fill=True,cm=mglearn.cm2)
score_image = mglearn.tools.plot_2d_scores(gbrt,X,ax=axes[1],
                                          alpha=.4,cm=mglearn.ReBl)

for ax in axes:
    mglearn.discrete_scatter(X_test[:,0],X_test[:,1],y_test,
                            markers='^',ax=ax)
    mglearn.discrete_scatter(X_train[:,0],X_train[:,1],y_train,
                            markers='o',ax=ax)
    ax.set_xlabel("feature 0 ")
    ax.set_ylabel("feature 1")
    
cbar =plt.colorbar(scores_image,ax=axes.tolist())
cbar.set_alpha(1)
cbar.draw.all()
axes[0].legend(["test class 0","test class 1","train class 0","train class 1"],ncol=4,loc=(.1,1.1))
```


    ---------------------------------------------------------------------------

    AttributeError                            Traceback (most recent call last)

    <ipython-input-83-d90385c78062> in <module>
         16 cbar =plt.colorbar(scores_image,ax=axes.tolist())
         17 cbar.set_alpha(1)
    ---> 18 cbar.draw.all()
         19 axes[0].legend(["test class 0","test class 1","train class 0","train class 1"],ncol=4,loc=(.1,1.1))
    

    AttributeError: 'Colorbar' object has no attribute 'draw'


    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_44_3.png)
    



```python
fig, axes = plt.subplots(1, 2, figsize=(13, 5))
    
mglearn.tools.plot_2d_separator(gbrt, X, ax=axes[0], alpha=.4,
                                fill=True, cm=mglearn.cm2)
scores_image = mglearn.tools.plot_2d_scores(gbrt, X, ax=axes[1],
                                            alpha=.4, cm=mglearn.ReBl)

for ax in axes:
    # 훈련 포인트와 테스트 포인트를 그리기
    mglearn.discrete_scatter(X_test[:, 0], X_test[:, 1], y_test,
                             markers='^', ax=ax)
    mglearn.discrete_scatter(X_train[:, 0], X_train[:, 1], y_train,
                             markers='o', ax=ax)
    ax.set_xlabel("특성 0")
    ax.set_ylabel("특성 1")
cbar = plt.colorbar(scores_image, ax=axes.tolist())
cbar.set_alpha(1)
cbar.draw_all()
axes[0].legend(["테스트 클래스 0", "테스트 클래스 1", "훈련 클래스 0",
                "훈련 클래스 1"], ncol=4, loc=(.1, 1.1))
plt.show() # 책에는 없음
```

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53580 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 49828 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53944 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53364 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 47000 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 54984 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 47144 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53580 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 49828 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53944 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53364 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 47000 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 54984 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 47144 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53580 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 49828 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53944 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53364 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 47000 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 54984 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 47144 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_45_2.png)
    



```python
gbrt.predict_proba(X_test)[:6]
```




    array([[0.016, 0.984],
           [0.846, 0.154],
           [0.981, 0.019],
           [0.974, 0.026],
           [0.014, 0.986],
           [0.025, 0.975]])




```python
fig, axes = plt.subplots(1, 2, figsize=(13, 5))
    
mglearn.tools.plot_2d_separator(
    gbrt, X, ax=axes[0], alpha=.4, fill=True, cm=mglearn.cm2)
scores_image = mglearn.tools.plot_2d_scores(
    gbrt, X, ax=axes[1], alpha=.5, cm=mglearn.ReBl, function='predict_proba')

for ax in axes:
    # 훈련 포인트와 테스트 포인트를 그리기
    mglearn.discrete_scatter(X_test[:, 0], X_test[:, 1], y_test,
                             markers='^', ax=ax)
    mglearn.discrete_scatter(X_train[:, 0], X_train[:, 1], y_train,
                             markers='o', ax=ax)
    ax.set_xlabel("특성 0")
    ax.set_ylabel("특성 1")
# colorbar 를 감추지 않습니다.
cbar = plt.colorbar(scores_image, ax=axes.tolist())
cbar.set_alpha(1)
cbar.draw_all()
axes[0].legend(["테스트 클래스 0", "테스트 클래스 1", "훈련 클래스 0",
                "훈련 클래스 1"], ncol=4, loc=(.1, 1.1))
plt.show() # 책에는 없음
```

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53580 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 49828 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53944 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 53364 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 47000 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 54984 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:238: RuntimeWarning: Glyph 47144 missing from current font.
      font.set_text(s, 0.0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53580 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 49828 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53944 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 53364 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 47000 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 54984 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_agg.py:201: RuntimeWarning: Glyph 47144 missing from current font.
      font.set_text(s, 0, flags=flags)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53945 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 49457 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53580 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 49828 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53944 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 53364 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 47000 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 54984 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\_backend_pdf_ps.py:102: RuntimeWarning: Glyph 47144 missing from current font.
      font.set_text(s, 0.0, flags=ft2font.LOAD_NO_HINTING)
    The PDF backend does not currently support the selected font.
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\formatters.py in __call__(self, obj)
        339                 pass
        340             else:
    --> 341                 return printer(obj)
        342             # Finally look for special method names
        343             method = get_real_method(obj, self.print_method)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in <lambda>(fig)
        254         svg_formatter.for_type(Figure, lambda fig: print_figure(fig, 'svg', **kwargs))
        255     if 'pdf' in formats:
    --> 256         pdf_formatter.for_type(Figure, lambda fig: print_figure(fig, 'pdf', **kwargs))
        257 
        258 #-----------------------------------------------------------------------------
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\IPython\core\pylabtools.py in print_figure(fig, fmt, bbox_inches, **kwargs)
        130         FigureCanvasBase(fig)
        131 
    --> 132     fig.canvas.print_figure(bytes_io, **kw)
        133     data = bytes_io.getvalue()
        134     if fmt == 'svg':
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
       2208 
       2209             try:
    -> 2210                 result = print_method(
       2211                     filename,
       2212                     dpi=dpi,
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backend_bases.py in wrapper(*args, **kwargs)
       1637             kwargs.pop(arg)
       1638 
    -> 1639         return func(*args, **kwargs)
       1640 
       1641     return wrapper
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
       2594             renderer.finalize()
       2595             if not isinstance(filename, PdfPages):
    -> 2596                 file.finalize()
       2597         finally:
       2598             if isinstance(filename, PdfPages):  # finish off this page
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in finalize(self)
        684 
        685         self.endStream()
    --> 686         self.writeFonts()
        687         self.writeExtGSTates()
        688         self._write_soft_mask_groups()
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in writeFonts(self)
        813                 chars = self._character_tracker.used.get(filename)
        814                 if chars:
    --> 815                     fonts[Fx] = self.embedTTF(filename, chars)
        816         self.writeObject(self.fontObject, fonts)
        817 
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTF(self, filename, characters)
       1280 
       1281         if fonttype == 3:
    -> 1282             return embedTTFType3(font, characters, descriptor)
       1283         elif fonttype == 42:
       1284             return embedTTFType42(font, characters, descriptor)
    

    c:\users\이준용\appdata\local\programs\python\python38-32\lib\site-packages\matplotlib\backends\backend_pdf.py in embedTTFType3(font, characters, descriptor)
       1069             # actual outlines)
       1070             try:
    -> 1071                 rawcharprocs = _ttconv.get_pdf_charprocs(
       1072                     os.fsencode(filename), glyph_ids)
       1073             except RuntimeError:
    

    RuntimeError: Failed to open TrueType font



    
![png](output_47_2.png)
    



```python
from sklearn.datasets import load_iris

iris = load_iris()
X_train,X_test,y_train,y_test = train_test_split(
    iris.data,iris.target,random_state=42)

gbrt = GradientBoostingClassifier(learning_rate=0.01,random_state=0)
gbrt.fit(X_train,y_train)

print(gbrt.decision_function(X_test).shape)
print(gbrt.decision_function(X_test)[:6,:])
```

    (38, 3)
    [[-1.996  0.048 -1.927]
     [ 0.061 -1.908 -1.928]
     [-1.991 -1.876  0.097]
     [-1.996  0.048 -1.927]
     [-1.997 -0.135 -1.203]
     [ 0.061 -1.908 -1.928]]
    


```python
np.argmax(gbrt.decision_function(X_test),axis=1)
```




    array([1, 0, 2, 1, 1, 0, 1, 2, 1, 1, 2, 0, 0, 0, 0, 1, 2, 1, 1, 2, 0, 2,
           0, 2, 2, 2, 2, 2, 0, 0, 0, 0, 1, 0, 0, 2, 1, 0], dtype=int32)




```python
gbrt.predict(X_test)
```




    array([1, 0, 2, 1, 1, 0, 1, 2, 1, 1, 2, 0, 0, 0, 0, 1, 2, 1, 1, 2, 0, 2,
           0, 2, 2, 2, 2, 2, 0, 0, 0, 0, 1, 0, 0, 2, 1, 0])




```python
logreg = LogisticRegression()

named_target = iris.target_names[y_train]
logreg.fit(X_train,named_target)
print(logreg.classes_)
print(logreg.predict(X_test)[:10])
argmax_dec_func = np.argmax(logreg.decision_function(X_test),axis=1)
print(argmax_dec_func[:10])

```

    ['setosa' 'versicolor' 'virginica']
    ['versicolor' 'setosa' 'virginica' 'versicolor' 'versicolor' 'setosa'
     'versicolor' 'virginica' 'versicolor' 'versicolor']
    [1 0 2 1 1 0 1 2 1 1]
    


```python
logreg.classes_[argmax_dec_func][:10]
```




    array(['versicolor', 'setosa', 'virginica', 'versicolor', 'versicolor',
           'setosa', 'versicolor', 'virginica', 'versicolor', 'versicolor'],
          dtype='<U10')


